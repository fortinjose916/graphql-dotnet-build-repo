{"version":3,"sources":["webpack:///path---docs-guides-dataloader-b3bd4c9cefebe47471f5.js","webpack:///./.cache/json/docs-guides-dataloader.json"],"names":["webpackJsonp","317","module","exports","data","markdownRemark","html","fields","relativePath","site","siteMetadata","githubEditUrl","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,KAAA,w+vBAA2pxBC,QAAyPC,aAAA,8BAA4CC,MAASC,cAAgBC,cAAA,6EAA4FC,aAAgBJ,aAAA","file":"path---docs-guides-dataloader-b3bd4c9cefebe47471f5.js","sourcesContent":["webpackJsonp([67274500541493],{\n\n/***/ 317:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1 id=\\\"dataloader\\\"><a href=\\\"#dataloader\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>DataLoader</h1>\\n<p>GraphQL .NET includes an implementation of Facebook's <a href=\\\"https://github.com/facebook/dataloader\\\">DataLoader</a>.</p>\\n<p>Consider a GraphQL query like this:</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"graphql\\\">\\n      <pre class=\\\"language-graphql\\\"><code class=\\\"language-graphql\\\"><span class=\\\"token punctuation\\\">{</span>\\n\\torders<span class=\\\"token punctuation\\\">(</span><span class=\\\"token attr-name\\\">date</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"2017-01-01\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\t\\torderId\\n\\t\\tdate\\n\\t\\tuser <span class=\\\"token punctuation\\\">{</span>\\n\\t\\t\\tuserId\\n\\t\\t\\tfirstName\\n\\t\\t\\tlastName\\n\\t\\t<span class=\\\"token punctuation\\\">}</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>When the query is executed, first a list of orders is fetched. Then for each order, the associated user must also be fetched. If each user is fetched one-by-one, this would get more inefficient as the number of orders (N) grows. This is known as the N+1 problem. If there are 50 orders (N = 50), 51 separate requests would be made to load this data.</p>\\n<p>A DataLoader helps in two ways:</p>\\n<ol>\\n<li>Similar operations are batched together. This can make fetching data over a network much more efficient.</li>\\n<li>Fetched values are cached so if they are requested again, the cached value is returned.</li>\\n</ol>\\n<p>In the example above, a using a DataLoader will allow us to batch together all of the requests for the users. So there would be 1 request to retrieve the list of orders and 1 request to load all users associated with those orders. This would always be a total of 2 requests rather than N+1.</p>\\n<h2 id=\\\"setup\\\"><a href=\\\"#setup\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Setup</h2>\\n<ol>\\n<li>Register <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> in your IoC container.</li>\\n<li>Register <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> in your IoC container.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\">services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">DataLoaderContextAccessor</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\nservices<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">DataLoaderDocumentListener</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<ol start=\\\"3\\\">\\n<li>Add the <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> to the <code class=\\\"language-text\\\">DocumentExecuter</code>.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">var</span> listener <span class=\\\"token operator\\\">=</span> Services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetRequiredService</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">DataLoaderDocumentListener</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> executer <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">DocumentExecuter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> result <span class=\\\"token operator\\\">=</span> executer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ExecuteAsync</span><span class=\\\"token punctuation\\\">(</span>opts <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">{</span>\\n\\n\\t<span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n\\topts<span class=\\\"token punctuation\\\">.</span>Listeners<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Add</span><span class=\\\"token punctuation\\\">(</span>listener<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"usage\\\"><a href=\\\"#usage\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Usage</h2>\\n<p>First, inject the <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> into your GraphQL type class.</p>\\n<p>Then use the the <code class=\\\"language-text\\\">Context</code> property on the accessor to get the current <code class=\\\"language-text\\\">DataLoaderContext</code>. Each request will have its own context instance.</p>\\n<p>Use one of the \\\"GetOrAddLoader\\\" methods on the <code class=\\\"language-text\\\">DataLoaderContext</code>. These methods all require a string key to uniquely identify each loader. They also require a delegate for fetching the data. Each method will get an existing loader or add a new one, identified by the string key. Each method has various overloads to support different ways to load and map data with the keys.</p>\\n<p>Call <code class=\\\"language-text\\\">LoadAsync()</code> on the data loader. This will queue the request and return a <code class=\\\"language-text\\\">Task&lt;T&gt;</code>. If the result has already been cached, the task returned will already be completed.</p>\\n<p>The <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> configured in the set up steps above automatically handles dispatching all pending data loader operations at each step of the document execution.</p>\\n<h2 id=\\\"examples\\\"><a href=\\\"#examples\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Examples</h2>\\n<p>This is an example of using a DataLoader to batch requests for loading items by a key. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each Order. <code class=\\\"language-text\\\">IUsersStore.GetUsersByIdAsync()</code> will be called with the batch of userIds that were requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrderType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">ObjectGraphType</span><span class=\\\"token operator\\\">&lt;</span>Order<span class=\\\"token operator\\\">></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">OrderType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">UserType</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">User</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"User\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>context <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n            \\t<span class=\\\"token comment\\\">// Get or add a batch loader with the key \\\"GetUsersById\\\"</span>\\n            \\t<span class=\\\"token comment\\\">// The loader will call GetUsersByIdAsync for each batch of keys</span>\\n                <span class=\\\"token keyword\\\">var</span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddBatchLoader</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">User</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetUsersById\\\"</span><span class=\\\"token punctuation\\\">,</span> users<span class=\\\"token punctuation\\\">.</span>GetUsersByIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch</span>\\n                <span class=\\\"token comment\\\">// The task will complete once the GetUsersByIdAsync() returns with the batched results</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// This will be called by the loader for all pending keys</span>\\n\\t<span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n\\tTask<span class=\\\"token operator\\\">&lt;</span>Dictionary<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span> <span class=\\\"token function\\\">GetUsersByIdAsync</span><span class=\\\"token punctuation\\\">(</span>IEnumerable<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token operator\\\">></span> userIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader to batch requests for loading a collection of items by a key. This is used when a key may be associated with more than one item. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each User. A User can have zero to many Orders. <code class=\\\"language-text\\\">IOrdersStore.GetOrdersByUserIdAsync</code> will be called with a batch of userIds that have been requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UserType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">ObjectGraphType</span><span class=\\\"token operator\\\">&lt;</span>User<span class=\\\"token operator\\\">></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">UserType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IOrdersStore</span> orders<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        Field<span class=\\\"token operator\\\">&lt;</span>ListGraphType<span class=\\\"token operator\\\">&lt;</span>OrderType<span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token operator\\\">&lt;</span>Order<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Orders\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n            \\t<span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetOrdersByUserId\\\"</span>\\n            \\t<span class=\\\"token comment\\\">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>\\n                <span class=\\\"token keyword\\\">var</span> ordersLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">Order</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetOrdersByUserId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    orders<span class=\\\"token punctuation\\\">.</span>GetOrdersByUserIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch data for</span>\\n                <span class=\\\"token comment\\\">// The task will complete with an IEnumberable&lt;Order> once the fetch delegate has returned</span>\\n                <span class=\\\"token keyword\\\">return</span> ordersLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>ctx<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrdersStore</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">IOrdersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">async</span> Task<span class=\\\"token operator\\\">&lt;</span>ILookup<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span> <span class=\\\"token function\\\">GetOrdersByUserIdAsync</span><span class=\\\"token punctuation\\\">(</span>IEnumerable<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token operator\\\">></span> userIds<span class=\\\"token punctuation\\\">)</span>\\n\\t<span class=\\\"token punctuation\\\">{</span>\\n\\t\\t<span class=\\\"token keyword\\\">var</span> orders <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span> <span class=\\\"token comment\\\">// load data from database</span>\\n\\n\\t\\t<span class=\\\"token keyword\\\">return</span> orders\\n\\t\\t\\t<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ToLookup</span><span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> x<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader without batching. This could be useful if the data may be requested multiple times. The result will be cached the first time. Subsequent calls to <code class=\\\"language-text\\\">LoadAsync()</code> will return the cached result.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">QueryType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">ObjectGraphType</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">QueryType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        Field<span class=\\\"token operator\\\">&lt;</span>ListGraphType<span class=\\\"token operator\\\">&lt;</span>UserType<span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token operator\\\">&lt;</span>User<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Description</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Get all Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n            \\t<span class=\\\"token comment\\\">// Get or add a loader with the key \\\"GetAllUsers\\\"</span>\\n                <span class=\\\"token keyword\\\">var</span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetOrAddLoader</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetAllUsers\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> users<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Prepare the load operation</span>\\n                <span class=\\\"token comment\\\">// If the result is cached, a completed Task&lt;IEnumerable&lt;User>> will be returned</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\tTask<span class=\\\"token operator\\\">&lt;</span>IEnumerable<span class=\\\"token operator\\\">&lt;</span>User<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span> <span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<blockquote>\\n<p>See this <a href=\\\"http://fiyazhasan.me/graphql-with-asp-net-core-part-x-data-loader-series-finale/\\\">blog series</a> for an in depth example using Entity Framework.</p>\\n</blockquote>\",\"fields\":{\"relativePath\":\"docs/guides/dataloader.md\"}},\"site\":{\"siteMetadata\":{\"githubEditUrl\":\"https://github.com/graphql-dotnet/graphql-dotnet/edit/master/docs2/site\"}}},\"pathContext\":{\"relativePath\":\"docs/guides/dataloader.md\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---docs-guides-dataloader-b3bd4c9cefebe47471f5.js","module.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1 id=\\\"dataloader\\\"><a href=\\\"#dataloader\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>DataLoader</h1>\\n<p>GraphQL .NET includes an implementation of Facebook's <a href=\\\"https://github.com/facebook/dataloader\\\">DataLoader</a>.</p>\\n<p>Consider a GraphQL query like this:</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"graphql\\\">\\n      <pre class=\\\"language-graphql\\\"><code class=\\\"language-graphql\\\"><span class=\\\"token punctuation\\\">{</span>\\n\\torders<span class=\\\"token punctuation\\\">(</span><span class=\\\"token attr-name\\\">date</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"2017-01-01\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\t\\torderId\\n\\t\\tdate\\n\\t\\tuser <span class=\\\"token punctuation\\\">{</span>\\n\\t\\t\\tuserId\\n\\t\\t\\tfirstName\\n\\t\\t\\tlastName\\n\\t\\t<span class=\\\"token punctuation\\\">}</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>When the query is executed, first a list of orders is fetched. Then for each order, the associated user must also be fetched. If each user is fetched one-by-one, this would get more inefficient as the number of orders (N) grows. This is known as the N+1 problem. If there are 50 orders (N = 50), 51 separate requests would be made to load this data.</p>\\n<p>A DataLoader helps in two ways:</p>\\n<ol>\\n<li>Similar operations are batched together. This can make fetching data over a network much more efficient.</li>\\n<li>Fetched values are cached so if they are requested again, the cached value is returned.</li>\\n</ol>\\n<p>In the example above, a using a DataLoader will allow us to batch together all of the requests for the users. So there would be 1 request to retrieve the list of orders and 1 request to load all users associated with those orders. This would always be a total of 2 requests rather than N+1.</p>\\n<h2 id=\\\"setup\\\"><a href=\\\"#setup\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Setup</h2>\\n<ol>\\n<li>Register <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> in your IoC container.</li>\\n<li>Register <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> in your IoC container.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\">services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">DataLoaderContextAccessor</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\nservices<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">AddSingleton</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">DataLoaderDocumentListener</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<ol start=\\\"3\\\">\\n<li>Add the <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> to the <code class=\\\"language-text\\\">DocumentExecuter</code>.</li>\\n</ol>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">var</span> listener <span class=\\\"token operator\\\">=</span> Services<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetRequiredService</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">DataLoaderDocumentListener</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> executer <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">DocumentExecuter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> result <span class=\\\"token operator\\\">=</span> executer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ExecuteAsync</span><span class=\\\"token punctuation\\\">(</span>opts <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">{</span>\\n\\n\\t<span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n\\topts<span class=\\\"token punctuation\\\">.</span>Listeners<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Add</span><span class=\\\"token punctuation\\\">(</span>listener<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"usage\\\"><a href=\\\"#usage\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Usage</h2>\\n<p>First, inject the <code class=\\\"language-text\\\">IDataLoaderContextAccessor</code> into your GraphQL type class.</p>\\n<p>Then use the the <code class=\\\"language-text\\\">Context</code> property on the accessor to get the current <code class=\\\"language-text\\\">DataLoaderContext</code>. Each request will have its own context instance.</p>\\n<p>Use one of the \\\"GetOrAddLoader\\\" methods on the <code class=\\\"language-text\\\">DataLoaderContext</code>. These methods all require a string key to uniquely identify each loader. They also require a delegate for fetching the data. Each method will get an existing loader or add a new one, identified by the string key. Each method has various overloads to support different ways to load and map data with the keys.</p>\\n<p>Call <code class=\\\"language-text\\\">LoadAsync()</code> on the data loader. This will queue the request and return a <code class=\\\"language-text\\\">Task&lt;T&gt;</code>. If the result has already been cached, the task returned will already be completed.</p>\\n<p>The <code class=\\\"language-text\\\">DataLoaderDocumentListener</code> configured in the set up steps above automatically handles dispatching all pending data loader operations at each step of the document execution.</p>\\n<h2 id=\\\"examples\\\"><a href=\\\"#examples\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Examples</h2>\\n<p>This is an example of using a DataLoader to batch requests for loading items by a key. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each Order. <code class=\\\"language-text\\\">IUsersStore.GetUsersByIdAsync()</code> will be called with the batch of userIds that were requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrderType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">ObjectGraphType</span><span class=\\\"token operator\\\">&lt;</span>Order<span class=\\\"token operator\\\">></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">OrderType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        <span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">Field</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">UserType</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">User</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"User\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>context <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n            \\t<span class=\\\"token comment\\\">// Get or add a batch loader with the key \\\"GetUsersById\\\"</span>\\n            \\t<span class=\\\"token comment\\\">// The loader will call GetUsersByIdAsync for each batch of keys</span>\\n                <span class=\\\"token keyword\\\">var</span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddBatchLoader</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">User</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetUsersById\\\"</span><span class=\\\"token punctuation\\\">,</span> users<span class=\\\"token punctuation\\\">.</span>GetUsersByIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch</span>\\n                <span class=\\\"token comment\\\">// The task will complete once the GetUsersByIdAsync() returns with the batched results</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>context<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// This will be called by the loader for all pending keys</span>\\n\\t<span class=\\\"token comment\\\">// Note that fetch delegates can accept a CancellationToken parameter or not</span>\\n\\tTask<span class=\\\"token operator\\\">&lt;</span>Dictionary<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> User<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span> <span class=\\\"token function\\\">GetUsersByIdAsync</span><span class=\\\"token punctuation\\\">(</span>IEnumerable<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token operator\\\">></span> userIds<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">CancellationToken</span> cancellationToken<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader to batch requests for loading a collection of items by a key. This is used when a key may be associated with more than one item. <code class=\\\"language-text\\\">LoadAsync()</code> is called by the field resolver for each User. A User can have zero to many Orders. <code class=\\\"language-text\\\">IOrdersStore.GetOrdersByUserIdAsync</code> will be called with a batch of userIds that have been requested.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UserType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">ObjectGraphType</span><span class=\\\"token operator\\\">&lt;</span>User<span class=\\\"token operator\\\">></span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">UserType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IOrdersStore</span> orders<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n        Field<span class=\\\"token operator\\\">&lt;</span>ListGraphType<span class=\\\"token operator\\\">&lt;</span>OrderType<span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token operator\\\">&lt;</span>Order<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Orders\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n            \\t<span class=\\\"token comment\\\">// Get or add a collection batch loader with the key \\\"GetOrdersByUserId\\\"</span>\\n            \\t<span class=\\\"token comment\\\">// The loader will call GetOrdersByUserIdAsync with a batch of keys</span>\\n                <span class=\\\"token keyword\\\">var</span> ordersLoader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token generic-method\\\"><span class=\\\"token function\\\">GetOrAddCollectionBatchLoader</span><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">Order</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetOrdersByUserId\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    orders<span class=\\\"token punctuation\\\">.</span>GetOrdersByUserIdAsync<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Add this UserId to the pending keys to fetch data for</span>\\n                <span class=\\\"token comment\\\">// The task will complete with an IEnumberable&lt;Order> once the fetch delegate has returned</span>\\n                <span class=\\\"token keyword\\\">return</span> ordersLoader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span>ctx<span class=\\\"token punctuation\\\">.</span>Source<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">OrdersStore</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">IOrdersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">async</span> Task<span class=\\\"token operator\\\">&lt;</span>ILookup<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">,</span> Order<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span> <span class=\\\"token function\\\">GetOrdersByUserIdAsync</span><span class=\\\"token punctuation\\\">(</span>IEnumerable<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token keyword\\\">int</span><span class=\\\"token operator\\\">></span> userIds<span class=\\\"token punctuation\\\">)</span>\\n\\t<span class=\\\"token punctuation\\\">{</span>\\n\\t\\t<span class=\\\"token keyword\\\">var</span> orders <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span> <span class=\\\"token comment\\\">// load data from database</span>\\n\\n\\t\\t<span class=\\\"token keyword\\\">return</span> orders\\n\\t\\t\\t<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ToLookup</span><span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> x<span class=\\\"token punctuation\\\">.</span>UserId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\t<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>This is an example of using a DataLoader without batching. This could be useful if the data may be requested multiple times. The result will be cached the first time. Subsequent calls to <code class=\\\"language-text\\\">LoadAsync()</code> will return the cached result.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"csharp\\\">\\n      <pre class=\\\"language-csharp\\\"><code class=\\\"language-csharp\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">QueryType</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token class-name\\\">ObjectGraphType</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">// Inject the IDataLoaderContextAccessor to access the current DataLoaderContext</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">QueryType</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">IDataLoaderContextAccessor</span> accessor<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token class-name\\\">IUsersStore</span> users<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        Field<span class=\\\"token operator\\\">&lt;</span>ListGraphType<span class=\\\"token operator\\\">&lt;</span>UserType<span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span> IEnumerable<span class=\\\"token operator\\\">&lt;</span>User<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Name</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Description</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Get all Users\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">ResolveAsync</span><span class=\\\"token punctuation\\\">(</span>ctx <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token punctuation\\\">{</span>\\n            \\t<span class=\\\"token comment\\\">// Get or add a loader with the key \\\"GetAllUsers\\\"</span>\\n                <span class=\\\"token keyword\\\">var</span> loader <span class=\\\"token operator\\\">=</span> accessor<span class=\\\"token punctuation\\\">.</span>Context<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetOrAddLoader</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"GetAllUsers\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                    <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> users<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                <span class=\\\"token comment\\\">// Prepare the load operation</span>\\n                <span class=\\\"token comment\\\">// If the result is cached, a completed Task&lt;IEnumerable&lt;User>> will be returned</span>\\n                <span class=\\\"token keyword\\\">return</span> loader<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">LoadAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">interface</span> <span class=\\\"token class-name\\\">IUsersStore</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\tTask<span class=\\\"token operator\\\">&lt;</span>IEnumerable<span class=\\\"token operator\\\">&lt;</span>User<span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">></span> <span class=\\\"token function\\\">GetAllUsersAsync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<blockquote>\\n<p>See this <a href=\\\"http://fiyazhasan.me/graphql-with-asp-net-core-part-x-data-loader-series-finale/\\\">blog series</a> for an in depth example using Entity Framework.</p>\\n</blockquote>\",\"fields\":{\"relativePath\":\"docs/guides/dataloader.md\"}},\"site\":{\"siteMetadata\":{\"githubEditUrl\":\"https://github.com/graphql-dotnet/graphql-dotnet/edit/master/docs2/site\"}}},\"pathContext\":{\"relativePath\":\"docs/guides/dataloader.md\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/docs-guides-dataloader.json\n// module id = 317\n// module chunks = 67274500541493"],"sourceRoot":""}